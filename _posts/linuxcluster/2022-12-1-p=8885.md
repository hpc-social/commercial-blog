---
author: The Linux Cluster
author_tag: linuxcluster
blog_subtitle: Linux Cluster Blog is a collection of how-to and tutorials for Linux
  Cluster and Enterprise Linux
blog_title: The Linux Cluster
blog_url: https://thelinuxcluster.com
category: linuxcluster
date: '2022-12-01 01:12:20'
layout: post
original_url: https://thelinuxcluster.com/2022/12/01/how-to-disable-cbc-mode-ciphers-in-rhel-8-or-rocky-linux-8/
slug: how-to-disable-cbc-mode-ciphers-in-rhel-8-or-rocky-linux-8
title: How to disable CBC Mode Ciphers in RHEL 8 or Rocky Linux 8
---

<p>This writeup is reference from  <a href="https://www.thegeekdiary.com/">The Geek Diary</a></p>




<ul>
<li><a href="https://www.thegeekdiary.com/how-to-disable-weak-cipher-and-insecure-hmac-algorithms-in-ssh-services-in-centos-rhel-8/">How To Disable Weak Cipher And Insecure HMAC Algorithms In SSH Services In CentOS/RHEL 8</a></li>



<li><a href="https://www.thegeekdiary.com/how-to-disable-weak-cipher-and-insecure-hmac-algorithms-in-ssh-services-for-centos-rhel-6-and-7/">How To Disable Weak Cipher And Insecure HMAC Algorithms in SSH services for CentOS/RHEL 6 and 7</a></li>
</ul>



<p>Edit&nbsp;<strong>/etc/sysconfig/sshd</strong>&nbsp;and uncomment CRYPTO_POLICY line:</p>




<pre class="wp-block-code"><code>CRYPTO_POLICY=</code></pre>



<p>Edit <strong>/etc/ssh/sshd_config</strong> file. Add Ciphers, MACs and KexAlgorithms have been added</p>




<pre class="wp-block-code"><code>KexAlgorithms curve25519-sha256@libssh.org,ecdh-sha2-nistp521,ecdh-sha2-nistp384,ecdh-sha2-nistp256,diffie-hellman-group-exchange-sha256
Ciphers chacha20-poly1305@openssh.com,aes256-gcm@openssh.com,aes128-gcm@openssh.com,aes256-ctr,aes192-ctr,aes128-ctr
MACs hmac-sha2-512-etm@openssh.com,hmac-sha2-256-etm@openssh.com,umac-128-etm@openssh.com,hmac-sha2-512,hmac-sha2-256,umac-128@openssh.com</code></pre>



<p>After making changes to the configuration file, you may want to do a sanity check on the configuration file</p>




<pre class="wp-block-code"><code># sshd -t</code></pre>



<p>Restart sshd services</p>




<pre class="wp-block-code"><code># systemctl restart sshd</code></pre>



<p>To test if weak CBC Ciphers are enabled</p>




<pre class="wp-block-code"><code>$ ssh -vv -oCiphers=3des-cbc,aes128-cbc,aes192-cbc,aes256-cbc &#091;youruserid@IP of your Server]
</code></pre>



<p>References:</p>




<ul>
<li><a href="https://www.thegeekdiary.com/how-to-disable-weak-cipher-and-insecure-hmac-algorithms-in-ssh-services-in-centos-rhel-8/">How To Disable Weak Cipher And Insecure HMAC Algorithms In SSH Services In CentOS/RHEL 8</a></li>



<li><a href="https://www.thegeekdiary.com/how-to-disable-weak-cipher-and-insecure-hmac-algorithms-in-ssh-services-for-centos-rhel-6-and-7/">How To Disable Weak Cipher And Insecure HMAC Algorithms in SSH services for CentOS/RHEL 6 and 7</a></li>



<li><a href="https://www.cyberciti.biz/tips/checking-openssh-sshd-configuration-syntax-errors.html">OpenSSH Tip: Check Syntax Errors before Restarting SSHD Server</a></li>
</ul>